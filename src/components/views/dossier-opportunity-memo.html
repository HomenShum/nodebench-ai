<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Funding Daily – Mock Flow Demo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg: #050816;
      --bg-soft: #0b1220;
      --bg-softer: #111827;
      --bg-card: #020617;
      --border-subtle: rgba(148, 163, 184, 0.25);
      --accent: #38bdf8;
      --accent-soft: rgba(56, 189, 248, 0.1);
      --accent-strong: #0ea5e9;
      --accent-contrast: #f9fafb;
      --accent-warn: #f97316;
      --accent-soft-warn: rgba(249, 115, 22, 0.12);
      --text: #e5e7eb;
      --text-soft: #9ca3af;
      --text-softer: #6b7280;
      --text-muted: #4b5563;
      --chip-bg: rgba(15, 23, 42, 0.85);
      --shadow-lg: 0 20px 45px rgba(15, 23, 42, 0.75);
      --radius-lg: 18px;
      --radius-md: 12px;
      --radius-pill: 999px;
    }

    * {
      box-sizing: border-box;
    }

    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text", sans-serif;
      background: radial-gradient(circle at top, #0b1220 0, #020617 45%, #000 100%);
      color: var(--text);
    }

    body {
      display: flex;
      align-items: stretch;
      justify-content: center;
    }

    .app-shell {
      width: 100%;
      max-width: 1240px;
      margin: 0 auto;
      padding: 16px;
      display: flex;
      flex-direction: column;
      gap: 16px;
      min-height: 100vh;
    }

    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .brand-logo {
      width: 32px;
      height: 32px;
      border-radius: 10px;
      background: radial-gradient(circle at 30% 0%, #f97316 0, #e11d48 35%, #4f46e5 70%, #0ea5e9 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 0 0 1px rgba(15, 23, 42, 0.9), 0 10px 30px rgba(15, 23, 42, 0.85);
      color: #f9fafb;
      font-size: 16px;
      font-weight: 700;
    }

    .brand-text-main {
      font-size: 15px;
      font-weight: 600;
      letter-spacing: 0.03em;
    }

    .brand-text-sub {
      font-size: 11px;
      color: var(--text-softer);
      text-transform: uppercase;
      letter-spacing: 0.14em;
    }

    .header-right {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 11px;
      color: var(--text-softer);
    }

    .chip {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 5px 9px;
      border-radius: var(--radius-pill);
      border: 1px solid rgba(148, 163, 184, 0.16);
      background: radial-gradient(circle at top left, #172554 0, #020617 50%);
      font-size: 11px;
      color: #e5e7eb;
    }

    .chip-dot {
      width: 7px;
      height: 7px;
      border-radius: 999px;
      background: #22c55e;
      box-shadow: 0 0 0 4px rgba(34, 197, 94, 0.22);
    }

    .chip-pill-soft {
      border-radius: var(--radius-pill);
      padding: 5px 9px;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(148, 163, 184, 0.2);
      color: var(--text-soft);
    }

    .layout-main {
      flex: 1;
      display: grid;
      grid-template-columns: 1.1fr 1.5fr 0.9fr;
      gap: 14px;
      min-height: 0;
    }

    @media (max-width: 1024px) {
      .layout-main {
        grid-template-columns: 1fr;
      }
    }

    .panel {
      background: radial-gradient(circle at top, #020617 0, #020617 50%);
      border-radius: var(--radius-lg);
      border: 1px solid var(--border-subtle);
      box-shadow: var(--shadow-lg);
      padding: 14px 14px 16px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      position: relative;
      overflow: hidden;
    }

    .panel::before {
      content: "";
      position: absolute;
      inset: -40%;
      opacity: 0.33;
      background:
        radial-gradient(circle at 0 0, rgba(56, 189, 248, 0.12) 0, transparent 50%),
        radial-gradient(circle at 100% 0, rgba(249, 115, 22, 0.11) 0, transparent 52%),
        radial-gradient(circle at 50% 120%, rgba(94, 234, 212, 0.08) 0, transparent 55%);
      pointer-events: none;
    }

    .panel-inner {
      position: relative;
      z-index: 1;
      display: flex;
      flex-direction: column;
      gap: 10px;
      min-height: 0;
    }

    .panel-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
    }

    .panel-title {
      font-size: 13px;
      font-weight: 600;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      color: var(--text-soft);
    }

    .panel-subtitle {
      font-size: 11px;
      color: var(--text-softer);
      margin-top: 2px;
    }

    .badge {
      padding: 3px 7px;
      border-radius: var(--radius-pill);
      font-size: 10px;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      background: rgba(15, 23, 42, 0.92);
      border: 1px solid rgba(148, 163, 184, 0.3);
      color: var(--text-soft);
    }

    .badge-soft {
      background: var(--accent-soft);
      color: var(--accent-strong);
      border-color: rgba(56, 189, 248, 0.5);
    }

    .badge-mini {
      padding: 2px 6px;
      border-radius: var(--radius-pill);
      font-size: 10px;
      color: var(--text-softer);
      border: 1px solid rgba(148, 163, 184, 0.3);
      background: rgba(15, 23, 42, 0.95);
    }

    .label {
      font-size: 11px;
      color: var(--text-soft);
      margin-bottom: 4px;
    }

    textarea, input[type="text"], input[type="email"], select {
      width: 100%;
      border-radius: 10px;
      border: 1px solid rgba(148, 163, 184, 0.4);
      background: rgba(15, 23, 42, 0.9);
      color: var(--text);
      padding: 9px 10px;
      font-size: 12px;
      resize: none;
      outline: none;
      transition: border-color 0.16s ease, box-shadow 0.16s ease, background 0.16s ease;
    }

    textarea::placeholder, input::placeholder {
      color: var(--text-muted);
    }

    textarea:focus, input:focus, select:focus {
      border-color: var(--accent-strong);
      box-shadow: 0 0 0 1px rgba(56, 189, 248, 0.55);
      background: radial-gradient(circle at top, #020617 0, #020617 55%);
    }

    .btn {
      border-radius: var(--radius-pill);
      border: none;
      outline: none;
      padding: 8px 14px;
      font-size: 12px;
      font-weight: 500;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      cursor: pointer;
      transition: transform 0.1s ease, box-shadow 0.1s ease, background 0.1s ease, opacity 0.1s ease;
      white-space: nowrap;
    }

    .btn-primary {
      background: linear-gradient(135deg, #22c55e, #0ea5e9);
      color: var(--accent-contrast);
      box-shadow: 0 12px 25px rgba(8, 47, 73, 0.9);
    }

    .btn-primary:hover {
      transform: translateY(-1px);
      box-shadow: 0 14px 30px rgba(15, 23, 42, 0.95);
      filter: brightness(1.04);
    }

    .btn-primary:active {
      transform: translateY(1px) scale(0.98);
      box-shadow: 0 8px 20px rgba(15, 23, 42, 0.9);
      filter: brightness(0.98);
    }

    .btn-ghost {
      background: rgba(15, 23, 42, 0.95);
      color: var(--text-soft);
      border: 1px solid rgba(148, 163, 184, 0.4);
    }

    .btn-ghost:hover {
      background: rgba(15, 23, 42, 0.98);
      color: var(--accent-strong);
      border-color: rgba(56, 189, 248, 0.6);
    }

    .btn-ghost:active {
      transform: translateY(1px) scale(0.99);
    }

    .btn-small {
      padding: 6px 10px;
      font-size: 11px;
    }

    .btn-icon {
      width: 22px;
      height: 22px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.95);
      border: 1px solid rgba(148, 163, 184, 0.35);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 11px;
      color: var(--text-soft);
    }

    .btn-icon:hover {
      border-color: var(--accent-strong);
      color: var(--accent-strong);
      background: rgba(15, 23, 42, 0.98);
      cursor: pointer;
    }

    .row {
      display: flex;
      flex-direction: row;
      gap: 8px;
      align-items: center;
    }

    .row-space-between {
      justify-content: space-between;
    }

    .pill-toggle-group {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }

    .pill-toggle {
      border-radius: var(--radius-pill);
      padding: 5px 9px;
      font-size: 11px;
      border: 1px solid rgba(148, 163, 184, 0.4);
      background: rgba(15, 23, 42, 0.95);
      color: var(--text-soft);
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      transition: background 0.14s ease, border-color 0.14s ease, color 0.14s ease, transform 0.08s ease;
    }

    .pill-toggle span.badge-dot {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: rgba(148, 163, 184, 0.7);
    }

    .pill-toggle.active {
      background: radial-gradient(circle at top left, rgba(56, 189, 248, 0.1) 0, rgba(15, 23, 42, 1) 60%);
      border-color: rgba(56, 189, 248, 0.6);
      color: var(--accent-strong);
      transform: translateY(-0.5px);
    }

    .pill-toggle.active span.badge-dot {
      background: #22c55e;
    }

    .hint {
      font-size: 11px;
      color: var(--text-softer);
    }

    .hint-strong {
      color: var(--accent-strong);
    }

    .hint-warn {
      color: var(--accent-warn);
    }

    .hint-mono {
      font-family: "SF Mono", ui-monospace, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 11px;
      color: var(--text-muted);
    }

    .divider-soft {
      border-top: 1px dashed rgba(148, 163, 184, 0.35);
      margin: 6px 0;
    }

    .sticky-toolbar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      padding: 6px 8px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.94);
      border: 1px solid rgba(148, 163, 184, 0.4);
      position: sticky;
      top: 0;
      z-index: 5;
      backdrop-filter: blur(16px);
    }

    .toolbar-metrics {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 11px;
      color: var(--text-softer);
    }

    .metric-dot {
      width: 4px;
      height: 4px;
      border-radius: 999px;
      background: rgba(148, 163, 184, 0.9);
    }

    .metric-label {
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.12em;
      font-size: 10px;
    }

    .metric-value {
      color: #e5e7eb;
      font-weight: 500;
    }

    .metric-pill {
      border-radius: var(--radius-pill);
      padding: 4px 7px;
      border: 1px solid rgba(148, 163, 184, 0.35);
      background: rgba(15, 23, 42, 0.96);
      display: inline-flex;
      align-items: center;
      gap: 5px;
      font-size: 10px;
      color: var(--text-softer);
    }

    .preview-frame {
      margin-top: 10px;
      border-radius: 12px;
      border: 1px solid rgba(148, 163, 184, 0.4);
      background: #f4f1e8;
      color: #111827;
      padding: 14px 16px;
      font-family: "Georgia", "Times New Roman", serif;
      font-size: 13px;
      max-height: 380px;
      overflow: auto;
      box-shadow: inset 0 0 0 1px rgba(15, 23, 42, 0.08);
    }

    .preview-header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      gap: 8px;
      border-bottom: 1px solid #d1c7af;
      padding-bottom: 6px;
      margin-bottom: 6px;
    }

    .preview-title-main {
      font-size: 18px;
      letter-spacing: 0.18em;
      text-transform: uppercase;
    }

    .preview-title-sub {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.18em;
      color: #6b7280;
    }

    .preview-meta {
      font-size: 11px;
      color: #6b7280;
      text-align: right;
    }

    .preview-section-title {
      font-size: 13px;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      margin: 8px 0 4px;
      border-top: 1px solid #d1c7af;
      padding-top: 5px;
    }

    .preview-company-row {
      display: grid;
      grid-template-columns: 1.6fr 1.1fr 1.1fr;
      gap: 8px;
      padding: 4px 0;
      border-top: 1px solid rgba(148, 163, 184, 0.3);
    }

    .preview-company-name {
      font-weight: 600;
      font-size: 13px;
    }

    .preview-company-tags {
      font-size: 10px;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      color: #6b7280;
    }

    .preview-company-notes {
      font-size: 12px;
    }

    .preview-link {
      font-size: 11px;
      color: #1d4ed8;
      text-decoration: underline;
      cursor: pointer;
    }

    .preview-footnote {
      font-size: 10px;
      color: #6b7280;
      margin-top: 8px;
      border-top: 1px solid #e5e7eb;
      padding-top: 5px;
    }

    .topic-chip {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 8px;
      border-radius: var(--radius-pill);
      border: 1px solid rgba(148, 163, 184, 0.35);
      background: rgba(15, 23, 42, 0.96);
      font-size: 11px;
      color: var(--text-soft);
      margin: 2px;
    }

    .topic-chip span.dot {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: #22c55e;
    }

    .topic-chip button {
      border: none;
      background: transparent;
      color: var(--text-muted);
      font-size: 11px;
      cursor: pointer;
      padding: 0;
    }

    .source-card-list {
      display: flex;
      flex-direction: column;
      gap: 6px;
      margin-top: 6px;
    }

    .source-card {
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      gap: 8px;
      padding: 7px 9px;
      border-radius: 11px;
      background: radial-gradient(circle at top left, rgba(15, 23, 42, 1) 0, rgba(15, 23, 42, 0.96) 55%);
      border: 1px solid rgba(148, 163, 184, 0.38);
      cursor: pointer;
      transition: transform 0.09s ease, box-shadow 0.09s ease, border-color 0.09s ease, background 0.09s ease;
    }

    .source-card:hover {
      transform: translateY(-1px);
      border-color: rgba(56, 189, 248, 0.7);
      box-shadow: 0 10px 22px rgba(15, 23, 42, 0.95);
      background: radial-gradient(circle at top left, #020617 0, rgba(15, 23, 42, 1) 55%);
    }

    .source-main {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .source-title {
      font-size: 12px;
      font-weight: 500;
    }

    .source-subline {
      font-size: 11px;
      color: var(--text-softer);
    }

    .source-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 4px;
      margin-top: 2px;
    }

    .source-tag-pill {
      border-radius: 999px;
      padding: 2px 6px;
      font-size: 10px;
      border: 1px solid rgba(148, 163, 184, 0.4);
      background: rgba(15, 23, 42, 0.98);
      color: var(--text-softer);
    }

    .source-icons {
      display: flex;
      flex-direction: column;
      align-items: flex-end;
      gap: 6px;
      font-size: 11px;
      color: var(--text-soft);
    }

    .source-icon-row {
      display: flex;
      gap: 4px;
    }

    .source-icon-pill {
      padding: 2px 6px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.98);
      border: 1px solid rgba(148, 163, 184, 0.4);
      font-size: 10px;
    }

    .toast {
      position: fixed;
      right: 16px;
      bottom: 16px;
      padding: 9px 11px;
      border-radius: 12px;
      background: radial-gradient(circle at top left, rgba(56, 189, 248, 0.16) 0, rgba(15, 23, 42, 1) 60%);
      border: 1px solid rgba(56, 189, 248, 0.6);
      color: var(--text);
      font-size: 12px;
      display: flex;
      align-items: center;
      gap: 8px;
      box-shadow: 0 14px 32px rgba(15, 23, 42, 0.95);
      z-index: 999;
      opacity: 0;
      pointer-events: none;
      transform: translateY(8px);
      transition: opacity 0.12s ease, transform 0.12s ease;
    }

    .toast.show {
      opacity: 1;
      transform: translateY(0);
      pointer-events: auto;
    }

    .toast-icon {
      width: 16px;
      height: 16px;
      border-radius: 999px;
      border: 1px solid rgba(56, 189, 248, 0.85);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 11px;
      color: var(--accent-strong);
      background: rgba(15, 23, 42, 1);
    }

    footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
      font-size: 11px;
      color: var(--text-softer);
      padding: 4px 2px;
    }

    @media (max-width: 640px) {
      header {
        flex-direction: column;
        align-items: flex-start;
      }
      .header-right {
        align-self: stretch;
        justify-content: space-between;
      }
      .sticky-toolbar {
        flex-direction: column;
        align-items: flex-start;
      }
      .toolbar-metrics {
        flex-wrap: wrap;
      }
      footer {
        flex-direction: column;
        align-items: flex-start;
      }
    }
  </style>
</head>
<body>
  <div class="app-shell">
    <header>
      <div class="brand">
        <div class="brand-logo">FD</div>
        <div>
          <div class="brand-text-main">Funding Daily (Mock)</div>
          <div class="brand-text-sub">Quote → Newsletter → Topics</div>
        </div>
      </div>
      <div class="header-right">
        <div class="chip">
          <div class="chip-dot"></div>
          <span>Live demo · local only · mock data</span>
        </div>
        <div class="chip-pill-soft">
          Cost model: free-tier ≈ shallow · paid ≈ deep
        </div>
      </div>
    </header>

    <main class="layout-main">
      <!-- Panel 1: Quote / Brief input -->
      <section class="panel">
        <div class="panel-inner">
          <div class="panel-header">
            <div>
              <div class="panel-title">Step 1 · Your Brief</div>
              <div class="panel-subtitle">
                From “cumbersome ask” → a clean, structured intent.
              </div>
            </div>
            <span class="badge">Input</span>
          </div>

          <div>
            <div class="label">What do you want in your inbox each morning?</div>
            <textarea id="briefInput" rows="6"
              placeholder='Example: "Send me daily seed & Series A funding in AI infra and digital health, with company, founders, and 3 bullets I can paste into my CRM."'></textarea>
            <div class="row row-space-between" style="margin-top: 4px;">
              <span class="hint">
                The agent will auto-parse sectors, stages, and geography from this single quote.
              </span>
              <span class="hint-mono" id="briefCharCount">0 chars</span>
            </div>
          </div>

          <div>
            <div class="label" style="margin-bottom: 4px;">Newsletter skin (only affects visuals, not sources)</div>
            <div class="pill-toggle-group" id="styleToggleGroup">
              <button type="button" class="pill-toggle active" data-style="hybrid">
                <span class="badge-dot"></span>
                Hybrid: WSJ × Daily Prophet
              </button>
              <button type="button" class="pill-toggle" data-style="wsj">
                <span class="badge-dot"></span>
                Wall Street Brief
              </button>
              <button type="button" class="pill-toggle" data-style="prophet">
                <span class="badge-dot"></span>
                Harry Potter Daily Prophet
              </button>
            </div>
          </div>

          <div class="divider-soft"></div>

          <div class="row row-space-between">
            <div class="hint">
              <span class="hint-strong">Goal:</span> In 1 click, go from this quote to a concrete, shippable email.
            </div>
            <button class="btn btn-primary" id="generateBtn">
              <span>Generate mock preview</span>
              <span>⏵</span>
            </button>
          </div>
        </div>
      </section>

      <!-- Panel 2: Newsletter preview with mock data -->
      <section class="panel">
        <div class="panel-inner">
          <div class="sticky-toolbar">
            <div class="toolbar-metrics">
              <div class="metric-pill">
                <span class="metric-dot"></span>
                <span class="metric-label">Mode</span>
                <span class="metric-value" id="toolbarMode">Hybrid Mock · Deep(ish)</span>
              </div>
              <div class="metric-pill">
                <span class="metric-dot"></span>
                <span class="metric-label">Companies</span>
                <span class="metric-value" id="toolbarCompanies">0</span>
              </div>
              <div class="metric-pill">
                <span class="metric-dot"></span>
                <span class="metric-label">Mock token burn</span>
                <span class="metric-value" id="toolbarCost">≈ 0.00$</span>
              </div>
            </div>
            <div class="row">
              <button class="btn btn-ghost btn-small" id="regenerateBtn">Refresh mock data</button>
            </div>
          </div>

          <div>
            <div class="panel-header" style="margin-top: 6px;">
              <div>
                <div class="panel-title">Step 2 · Preview</div>
                <div class="panel-subtitle">
                  HTML body as your investor tape – ready to ship to Gmail.
                </div>
              </div>
              <span class="badge badge-soft">Email HTML</span>
            </div>

            <div class="preview-frame" id="newsletterPreview">
              <!-- Populated by JS -->
              <div style="text-align:center; color:#6b7280; font-style:italic; margin-top:40px;">
                Hit “Generate mock preview” to see your WSJ × Daily Prophet style digest.
              </div>
            </div>
          </div>

          <div class="divider-soft"></div>

          <div class="row row-space-between">
            <div class="hint">
              This mock uses <span class="hint-strong">static demo data</span> – only the layout and flow are real.
            </div>
            <div class="row">
              <button class="btn btn-ghost btn-small" id="copyHtmlBtn">Copy HTML</button>
            </div>
          </div>
        </div>
      </section>

      <!-- Panel 3: Topics & subscription -->
      <section class="panel">
        <div class="panel-inner">
          <div class="panel-header">
            <div>
              <div class="panel-title">Step 3 · Topics & Subscription</div>
              <div class="panel-subtitle">
                Mock UI for per-email topics & deep vs shallow search.
              </div>
            </div>
            <span class="badge">Mock</span>
          </div>

          <div>
            <div class="label">Email to send this digest to</div>
            <input id="emailInput" type="email" placeholder="you@firm.com" />
            <div class="hint">
              In the real app this would use <span class="hint-strong">Resend</span> with this exact HTML body.
            </div>
          </div>

          <div>
            <div class="label">Topics you’re tracking with this email</div>
            <div id="topicsContainer"></div>
            <div class="row" style="margin-top: 6px;">
              <input id="topicInput" type="text" placeholder="Add a topic, e.g. &quot;AI infra seed&quot;" />
              <button class="btn btn-ghost btn-small" id="addTopicBtn">＋</button>
            </div>
            <div class="hint">
              Behind the scenes: each topic = one agent profile (sectors, stages, depth).
            </div>
          </div>

          <div>
            <div class="label">Search depth (mock only)</div>
            <div class="pill-toggle-group" id="depthToggleGroup">
              <button type="button" class="pill-toggle active" data-depth="shallow">
                <span class="badge-dot"></span>
                Free: GPT-5 Mini + standard LinkUp
              </button>
              <button type="button" class="pill-toggle" data-depth="deep">
                <span class="badge-dot"></span>
                Paid: GPT-5 + deep LinkUp
              </button>
            </div>
            <div class="hint">
              Real unit economics would cap <span class="hint-warn">deep</span> runs per month per email.
            </div>
          </div>

          <div>
            <div class="label">Sources touched for this mock newsletter</div>
            <div class="source-card-list" id="sourceCardList">
              <!-- Populated by JS -->
            </div>
            <div class="hint" style="margin-top: 4px;">
              Hover mentally: each card = “coffee card” linked view. In the real app you’d click to open video, deck, or doc.
            </div>
          </div>

          <div class="divider-soft"></div>

          <div class="row row-space-between">
            <button class="btn btn-ghost btn-small" id="simulateSendBtn">
              Simulate send to my Gmail
            </button>
            <span class="hint-mono">
              Convex collections (conceptual): <strong>briefs</strong>, <strong>newsletters</strong>, <strong>subscriptions</strong>.
            </span>
          </div>
        </div>
      </section>
    </main>

    <footer>
      <span>
        This file is 100% self-contained: HTML + CSS + JS + mock data. No backend, no network calls.
      </span>
      <span class="hint-mono">
        Next 2 hours IRL: wire Convex + Resend + actual OpenAI/LinkUp calls behind this exact shape.
      </span>
    </footer>

    <div class="toast" id="toast">
      <div class="toast-icon">✓</div>
      <div id="toastText">Mock email “sent” to your Gmail.</div>
    </div>
  </div>

  <script>
    // ---------- Mock data ----------

    const MOCK_DEALS = [
      {
        name: "OutcomesAI",
        stage: "Seed",
        amount: "$10M",
        sector: "Digital health · Virtual nursing",
        geo: "US",
        theme: "AI-powered nursing & virtual care",
        whyItMatters:
          "Lets health systems scale nursing capacity without burning out staff; aligns with value-based care and telehealth.",
        crmHook:
          "Flag OutcomesAI as a priority AI-in-healthcare contact for hospital system intros.",
        links: [
          { label: "Coverage", type: "article", url: "#" },
          { label: "Site", type: "site", url: "#" }
        ],
        sources: ["HealthTech News", "Company site"]
      },
      {
        name: "Praan Health",
        stage: "Seed",
        amount: "₹8.5 Cr (~$1M)",
        sector: "Healthtech · Chronic care & elder support",
        geo: "India",
        theme: "Coordinated care for aging parents",
        whyItMatters:
          "Taps into India’s aging population and cross-city caregiving burden; potential gateway into employer benefits.",
        crmHook:
          "Tag as early-life chronic-care infra; monitor for Series A fundraise and potential benefits-platform partners.",
        links: [{ label: "Funding note", type: "article", url: "#" }],
        sources: ["TICE", "Local startup press"]
      },
      {
        name: "RAGE Biotech",
        stage: "Series A",
        amount: "$29M",
        sector: "Biotech · RNA therapeutics",
        geo: "Australia",
        theme: "Precision RNA therapies",
        whyItMatters:
          "Signals investor conviction in RNA beyond mRNA vaccines; potential strategic fit with big pharma pipelines.",
        crmHook:
          "Track for partnering or co-dev deals rather than near-term revenue; ties to RNA platforms in your network.",
        links: [{ label: "Funding article", type: "article", url: "#" }],
        sources: ["BioPharmaDispatch"]
      },
      {
        name: "MediView XR",
        stage: "Series A",
        amount: "$24M",
        sector: "Medtech · AR surgical navigation",
        geo: "US",
        theme: "AR ‘X-ray vision’ in minimally invasive procedures",
        whyItMatters:
          "Bridges imaging and intervention; strong signal with strategics like GE HealthCare in the round.",
        crmHook:
          "Consider surgeons and hospital systems in your network who could be lighthouse customers or advisors.",
        links: [{ label: "Press release", type: "article", url: "#" }],
        sources: ["MediView", "MobiHealthNews"]
      },
      {
        name: "Wonderful",
        stage: "Series A",
        amount: "$100M",
        sector: "AI · Agent infra",
        geo: "Israel",
        theme: "Autonomous AI agents for enterprise workflows",
        whyItMatters:
          "Massive A-round shows continued appetite for agent platforms; useful comp for any ‘agentic’ pitch you see.",
        crmHook:
          "Benchmark your AI infra companies against Wonderful’s GTM and pricing; track for ecosystem plays.",
        links: [{ label: "AI Daily", type: "article", url: "#" }],
        sources: ["AI Daily"]
      },
      {
        name: "Uare.ai",
        stage: "Seed",
        amount: "$10.3M",
        sector: "AI · Individual AI layer",
        geo: "Global",
        theme: "Persistent personal AI agents",
        whyItMatters:
          "Bet on ‘personal AI OS’; could partner with firms that own data exhaust (consumer apps, fintech, health).",
        crmHook:
          "Use narrative as pattern: ‘individual AI’ framing may resonate with early-stage founders in your pipeline.",
        links: [{ label: "Launch note", type: "article", url: "#" }],
        sources: ["Futurism Today"]
      },
      {
        name: "Nyayanidhi",
        stage: "Seed",
        amount: "$2M",
        sector: "Legaltech · Case management",
        geo: "India",
        theme: "Streamlined litigation workflow",
        whyItMatters:
          "Legal process remains under-automated; cross-pollinates with workflow automation plays in your portfolio.",
        crmHook:
          "Map to any law-firm or legal-BPO contacts; potential joint pilots around AI summarization and doc routing.",
        links: [{ label: "Funding brief", type: "article", url: "#" }],
        sources: ["StartupNews.fyi"]
      }
    ];

    const MOCK_SOURCE_CARDS = [
      {
        id: "health",
        title: "Digital Health Funding Pulse – Early Stage",
        subline: "OutcomesAI, Praan Health, MediView XR, quilt of chronic-care and AR navigation.",
        tags: ["Digital Health", "Seed & Series A", "Provider workflow"],
        icons: ["DOCS", "PDF", "IMG"]
      },
      {
        id: "biotech",
        title: "RAGE Biotech: Precision RNA in Focus",
        subline: "Platform, pipeline, leadership changes, and Series A investor stack.",
        tags: ["RNA", "Platform biotech", "Series A"],
        icons: ["PDF", "IMG"]
      },
      {
        id: "ai-agents",
        title: "Wonderful & Uare.ai: Agent Infrastructure vs Personal AI",
        subline: "Contrasting visions for how agents show up in enterprise vs daily life.",
        tags: ["AI Agents", "Infra", "Seed & A"],
        icons: ["VIDEO", "DOCS", "LINK"]
      },
      {
        id: "legal-hr",
        title: "Nyayanidhi & Workflow SaaS Comps",
        subline: "Legaltech workflow parallels with HR and compliance tooling.",
        tags: ["Legaltech", "Workflow", "SaaS"],
        icons: ["DOCS", "LINK"]
      }
    ];

    const topics = new Set(["AI infra seed", "Digital health", "Biotech RNA"]);

    // ---------- Helpers ----------

    function $(id) {
      return document.getElementById(id);
    }

    function showToast(message) {
      const toast = $("toast");
      $("toastText").textContent = message;
      toast.classList.add("show");
      setTimeout(() => {
        toast.classList.remove("show");
      }, 2400);
    }

    function updateBriefCharCount() {
      const value = $("briefInput").value || "";
      $("briefCharCount").textContent = `${value.length} chars`;
    }

    function getSelectedStyle() {
      const buttons = document.querySelectorAll("#styleToggleGroup .pill-toggle");
      for (const btn of buttons) {
        if (btn.classList.contains("active")) return btn.dataset.style || "hybrid";
      }
      return "hybrid";
    }

    function getSelectedDepth() {
      const buttons = document.querySelectorAll("#depthToggleGroup .pill-toggle");
      for (const btn of buttons) {
        if (btn.classList.contains("active")) return btn.dataset.depth || "shallow";
      }
      return "shallow";
    }

    function setToolbarMetrics(dealCount) {
      const depth = getSelectedDepth();
      const shallowCostPerCompany = 0.003;
      const deepCostPerCompany = 0.012;
      const cost = (depth === "shallow" ? shallowCostPerCompany : deepCostPerCompany) * dealCount;
      $("toolbarCompanies").textContent = dealCount;
      $("toolbarCost").textContent = `≈ $${cost.toFixed(2)}`;

      const style = getSelectedStyle();
      let modeText = "";
      if (style === "wsj") modeText = "WSJ-style brief";
      else if (style === "prophet") modeText = "Daily Prophet-style";
      else modeText = "Hybrid: WSJ × Daily Prophet";

      modeText += depth === "deep" ? " · Mock deep" : " · Mock shallow";
      $("toolbarMode").textContent = modeText;
    }

    // ---------- Preview rendering ----------

    function renderNewsletterPreview() {
      const brief = $("briefInput").value.trim() || "Daily early-stage funding tape with healthcare, life sciences, and tech you actually care about.";
      const style = getSelectedStyle();
      const depth = getSelectedDepth();

      // In the real app: filter MOCK_DEALS based on parsed sectors/stages.
      const deals = [...MOCK_DEALS];
      const today = new Date();
      const dateStr = today.toLocaleDateString("en-US", {
        weekday: "short",
        month: "short",
        day: "numeric",
        year: "numeric"
      });

      setToolbarMetrics(deals.length);

      let mastheadTitle = "FUNDING DAILY";
      let mastheadSubtitle = "Seed & Series A — Healthcare, Life Sci, Tech";
      let toneLine = "“The tape, decoded so you can sound dangerously prepared in 5 minutes.”";

      if (style === "wsj") {
        mastheadTitle = "FUNDING JOURNAL";
        mastheadSubtitle = "Early-Stage Deals & Signals";
        toneLine = "A practical brief for outreach – not a hype reel.";
      } else if (style === "prophet") {
        mastheadTitle = "THE DAILY FUNDING PROPHET";
        mastheadSubtitle = "WHISPERS FROM THE VENTURE REALMS";
        toneLine = "Mysterious rounds appear in the night – we chart their omens at dawn.";
      }

      const sectionHealth = deals.filter((d) => d.sector.toLowerCase().includes("health"));
      const sectionBio = deals.filter((d) => d.sector.toLowerCase().includes("biotech"));
      const sectionTech = deals.filter(
        (d) =>
          !sectionHealth.includes(d) &&
          !sectionBio.includes(d)
      );

      function sectionRows(title, data) {
        if (!data.length) return "";
        return `
          <div class="preview-section">
            <div class="preview-section-title">${title}</div>
            ${data
              .map(
                (d) => `
              <div class="preview-company-row">
                <div>
                  <div class="preview-company-name">${d.name}</div>
                  <div class="preview-company-tags">${d.stage.toUpperCase()} · ${d.amount} · ${
                  d.geo
                }</div>
                </div>
                <div class="preview-company-notes">
                  <strong>${d.theme}</strong><br/>
                  ${d.whyItMatters}
                </div>
                <div class="preview-company-notes">
                  <em>Outreach angle:</em> ${d.crmHook}<br/>
                  ${
                    d.links && d.links.length
                      ? `<span class="preview-link">View sources (${d.links.length})</span>`
                      : ""
                  }
                </div>
              </div>
            `
              )
              .join("")}
          </div>
        `;
      }

      const wizardLine =
        style === "prophet" || style === "hybrid"
          ? `<div style="font-size:11px; color:#4b5563; margin-bottom:4px;">
              <em>Special enchantment:</em> your original quote is kept as the spellbook behind this layout.
            </div>`
          : "";

      const depthLine =
        depth === "deep"
          ? `<strong>Depth mode:</strong> mock “deep search” (would hit more sources, more context, higher token cost).`
          : `<strong>Depth mode:</strong> mock “standard search” (enough to triage, cheap to run).`;

      const html = `
        <div class="preview-header">
          <div>
            <div class="preview-title-main">${mastheadTitle}</div>
            <div class="preview-title-sub">${mastheadSubtitle}</div>
          </div>
          <div class="preview-meta">
            ${dateStr}<br/>
            Seed & Series A · Mock edition
          </div>
        </div>

        <div style="font-size:12px; margin-bottom:6px;">
          <strong>Reader brief:</strong> ${brief}
        </div>
        <div style="font-size:11px; color:#6b7280; margin-bottom:6px;">
          ${toneLine}
        </div>
        ${wizardLine}

        ${sectionRows("Digital health & workflows", sectionHealth)}
        ${sectionRows("Biotech & life sciences", sectionBio)}
        ${sectionRows("AI, legaltech & broader tech", sectionTech)}

        <div class="preview-footnote">
          ${depthLine}<br/>
          Sources are de-duplicated and ranked; in the real engine this footnote would show which outlets and docs were actually touched today.
        </div>
      `;

      $("newsletterPreview").innerHTML = html;
    }

    // ---------- Topic & source card rendering ----------

    function renderTopics() {
      const container = $("topicsContainer");
      container.innerHTML = "";
      if (!topics.size) {
        container.innerHTML =
          '<div class="hint">No topics yet. Add something like “Elder care seed” or “AI agents Europe”.</div>';
        return;
      }

      topics.forEach((topic) => {
        const el = document.createElement("span");
        el.className = "topic-chip";
        el.innerHTML = `
          <span class="dot"></span>
          <span>${topic}</span>
          <button type="button" data-topic="${topic}">×</button>
        `;
        container.appendChild(el);
      });

      container.querySelectorAll("button[data-topic]").forEach((btn) => {
        btn.addEventListener("click", () => {
          topics.delete(btn.dataset.topic);
          renderTopics();
        });
      });
    }

    function renderSourceCards() {
      const list = $("sourceCardList");
      list.innerHTML = "";
      MOCK_SOURCE_CARDS.forEach((card) => {
        const el = document.createElement("div");
        el.className = "source-card";
        el.innerHTML = `
          <div class="source-main">
            <div class="source-title">${card.title}</div>
            <div class="source-subline">${card.subline}</div>
            <div class="source-tags">
              ${card.tags
                .map((tag) => `<span class="source-tag-pill">${tag}</span>`)
                .join("")}
            </div>
          </div>
          <div class="source-icons">
            <div class="source-icon-row">
              ${card.icons
                .map((icon) => `<span class="source-icon-pill">${icon}</span>`)
                .join("")}
            </div>
            <div style="font-size:10px; text-transform:uppercase; letter-spacing:0.12em;">
              Hover → open in workspace (real app)
            </div>
          </div>
        `;
        list.appendChild(el);
      });
    }

    // ---------- Event wiring ----------

    function setupToggles(groupId) {
      const group = $(groupId);
      if (!group) return;
      group.querySelectorAll(".pill-toggle").forEach((btn) => {
        btn.addEventListener("click", () => {
          group.querySelectorAll(".pill-toggle").forEach((b) => b.classList.remove("active"));
          btn.classList.add("active");
          if (groupId === "depthToggleGroup" || groupId === "styleToggleGroup") {
            renderNewsletterPreview();
          }
        });
      });
    }

    function copyHtmlToClipboard() {
      const html = $("newsletterPreview").innerHTML;
      if (!html || html.includes("Generate mock preview")) {
        showToast("Nothing to copy yet – generate a preview first.");
        return;
      }

      const fullHtml =
        "<!DOCTYPE html><html><head><meta charset='UTF-8'><title>Funding Daily</title></head><body>" +
        html +
        "</body></html>";

      navigator.clipboard
        .writeText(fullHtml)
        .then(() => showToast("Newsletter HTML copied to clipboard (ready for Resend)."))
        .catch(() => showToast("Clipboard unavailable – copy manually if needed."));
    }

    function simulateSend() {
      const email = $("emailInput").value.trim();
      if (!email) {
        showToast("Enter an email to simulate sending.");
        return;
      }
      showToast(`Mock: would send this newsletter to ${email}.`);
    }

    function addTopic() {
      const input = $("topicInput");
      const value = input.value.trim();
      if (!value) return;
      topics.add(value);
      input.value = "";
      renderTopics();
    }

    // ---------- Init ----------

    document.addEventListener("DOMContentLoaded", () => {
      updateBriefCharCount();
      $("briefInput").addEventListener("input", updateBriefCharCount);

      $("generateBtn").addEventListener("click", renderNewsletterPreview);
      $("regenerateBtn").addEventListener("click", renderNewsletterPreview);
      $("copyHtmlBtn").addEventListener("click", copyHtmlToClipboard);
      $("simulateSendBtn").addEventListener("click", simulateSend);

      $("addTopicBtn").addEventListener("click", addTopic);
      $("topicInput").addEventListener("keydown", (e) => {
        if (e.key === "Enter") {
          e.preventDefault();
          addTopic();
        }
      });

      setupToggles("styleToggleGroup");
      setupToggles("depthToggleGroup");
      renderTopics();
      renderSourceCards();

      // Seed a default brief so the user can just click once
      $("briefInput").value =
        'Hey, I just want seed & Series A companies in AI infra, digital health, and biotech sent to my inbox each morning, with enough context to reach out to the founders.';
      updateBriefCharCount();
    });
  </script>
</body>
</html>
